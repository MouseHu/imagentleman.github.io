var root,mobius_ready=!1,delay,hover,x,y,shadow_height=0,window_height=0,scrolling=!1,shadow_scrolling=!1,last_yper=0,request=0,scroll_shadow=!1,offset=0,MutationObserver=window.MutationObserver||window.WebKitMutationObserver,observer=new MutationObserver(function(a){!0===mobius_ready&&a.forEach(function(a){0<a.addedNodes.length&&"STYLE"!==a.addedNodes[0].nodeName&&(window.clearTimeout(delay),delay=window.setTimeout(function(){repaint();0===shadow_height&&close()},3E3))})});
function get_style(a){a.url&&-1!==a.url.indexOf(window.location.origin)&&$.get(a.url,function(a){-1===a.indexOf("@font-face")&&$("#mobius-castle").append($("<style>").text(a))})}
function repaint(){var a=$("#mobius-castle");a.css("opacity","0");var b=$("body").clone();b.find("#mobius-castle, audio, video, embed, script").remove();var c=$("style").clone();b.prepend(c);for(var c=$("link[rel=stylesheet]"),d=0;d<c.length;d++)get_style({url:c[d].href});root.html(b.html());a.css("opacity","0.2");
shadow_height=a.height();.1*shadow_height>window_height?(scroll_shadow=!0,offset_shadow()):scroll_shadow=!1}function scroll(){if(!1===scrolling){scrolling=!0;var a=(y+offset)/(.1*shadow_height);last_yper!==a?($(window).scrollTop(a*document.body.scrollHeight),scrolling=!1,request=requestAnimationFrame(scroll)):(scrolling=!1,cancelAnimationFrame(request));last_yper=a}}function start_animation(){!1===scrolling&&(request=requestAnimationFrame(scroll))}
function offset_shadow(){shadow_scrolling=!0;var a=window.scrollY/document.body.scrollHeight,b=.1*shadow_height-window_height;$("#mobius-castle").css("top",-b*a);offset=b*a;shadow_scrolling=!1}
function init(){scroll_shadow=shadow_scrolling=scrolling=mobius_ready=!1;observer.observe(document.body,{childList:!0,subtree:!0});var a=$("<div>",{id:"mobius-castle"}).css({position:"fixed",top:"0","-webkit-transform-origin":"0 0","transform-origin":"0 0","-webkit-transform":"scale(.1, .1)",transform:"scale(.1, .1)",left:"0",opacity:"0","z-index":"123456789",cursor:"pointer",overflow:"hidden","background-color":"white","box-shadow":"-3px 0px 36px 0px #444"}).hover(function(){$(this).css("opacity",
"0.8");cancelAnimationFrame(request)},function(){$(this).css("opacity","0.2");cancelAnimationFrame(request)});$("body").append(a);a=$("#mobius-castle");a.append($("<div>"));root=$("#mobius-castle > div");window_height=$(window).height();repaint();mobius_ready=!0;a.css("width",document.body.clientWidth);a.css("opacity","0.2");$(window).resize(function(){window_height=$(window).height();repaint();!0===scroll_shadow&&!1===shadow_scrolling&&!1===scrolling&&offset_shadow()});$("#mobius-castle").mousemove(function(a){x=
a.clientX;y=a.clientY;start_animation()});$("#mobius-castle").mouseout(function(a){cancelAnimationFrame(request)});$(document).scroll(function(a){!0===scroll_shadow&&!1===shadow_scrolling&&!1===scrolling&&offset_shadow()})}function close(){observer.disconnect();$(window).off();$(document).off();$("#mobius-castle").off();$("#mobius-castle").remove()}$(document).ready(function(){init()});$(window).load(function(){repaint()});